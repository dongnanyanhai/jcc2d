<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<title>EaselJS: Simple Transform Example</title>
    <meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,minimum-scale=1.0,user-scalable=no">
	<script src="./js/easeljs-NEXT.combined.js"></script>
	<script src="../libs/stats.min.js"></script>
	<style type="text/css">
		* {
			margin: 0;
		}
	</style>
</head>

<body onload="init()">

<canvas id="testCanvas" width="960" height="400"></canvas>


<script id="editable">
	var img;
	var stage;
	var angle;
	var w;
	var h;
	var ww = window.innerWidth,
		wh = window.innerHeight;

	var stats = new Stats();
    stats.domElement.style.position = 'absolute';
    stats.domElement.style.top = '0px';
    document.body.appendChild(stats.domElement);

	function init() {
		angle = 0;
		img = new Image();
		img.onload = handleImageLoad;
		img.src = "./images/robot.png";
	}

	function stop() {
		createjs.Ticker.removeEventListener("tick", tick);
	}

	function handleImageLoad() {
		var canvas = document.getElementById("testCanvas");
		stage = new createjs.Stage(canvas);
		stage.autoClear = true;
		resize(ww,wh);
		bmp = new createjs.Bitmap(img);
		bmp.regX = img.width >> 1;
		bmp.regY = img.height >> 1;
		bmp.x = w = canvas.width >> 1;
		bmp.y = canvas.height >> 1;
		bmp.scaleX = bmp.scaleY = 0.1;
		stage.addChild(bmp);
		stage.update();

		createjs.Ticker.timingMode = createjs.Ticker.RAF;
		createjs.Ticker.addEventListener("tick", tick);
	}

	function tick(event) {
		angle += 0.01;
		var value = Math.sin(angle) * 360;

		bmp.rotation = value;
		bmp.scaleX = bmp.scaleY = 0.3 + 0.5*Math.abs(value / 360);
		bmp.x = w + value*0.4;
		stage.update(event);

    	stats.update();
	}

	function resize(w,h){
		stage.canvas.width = w;
		stage.canvas.height = h;
	}

</script>
</body>
</html>
