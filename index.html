<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,minimum-scale=1.0,user-scalable=no">
    <link rel="stylesheet" type="text/css" href="./css/main.css">
</head>

<body>
    <canvas id="canvas" width="640" height="550"></canvas>
    <div class="navgator">
        <div class="documention"><a href="docs">documention</a></div>
        <div class="examples"><a href="examples">examples</a></div>
    </div>
    <script type="text/javascript" src="./examples/libs/jcc2d.js"></script>
    <script type="text/javascript">
    function modulo(n, m) {
        return ((n % m) + m) % m;
    }

    window.onresize = window.onload = function() {
        resize();
    };
    var w = window.innerWidth,
        h = window.innerHeight,
        TWO_PI = Math.PI * 2,
        stage = new JC.Stage('canvas'),
        DOC = new JC.Container();

    function Circle(opts) {
        opts = opts || {};
        this.live = opts.live || 5000;
        this.space = opts.space || 1000;
        this.radius = opts.radius;
        this.color = '#db3c79';
        this.scale = 1;
        this.alpha = 1;
    }
    Circle.prototype.update = function(idx, time) {
        this.scale = 1 + Math.pow(2 * modulo(idx * this.space + time, this.live) / this.live, 0.9);
        this.alpha = 0.9 * (1 - Math.pow(modulo(idx * this.space + time, this.live) / this.live, 0.9));
    };
    Circle.prototype.render = function(ctx) {
        ctx.save();
        ctx.transform(this.scale, 0, 0, this.scale, 0, 0);
        ctx.globalAlpha = this.alpha;
        ctx.fillStyle = this.color;
        ctx.beginPath();
        ctx.arc(0, 0, this.radius, 0, TWO_PI);
        ctx.closePath();
        ctx.fill();
        ctx.globalAlpha = 1;
        ctx.restore();
    };

    function CircleGloup(opts) {
        opts = opts || {};
        this.radius = opts.radius || 100;
        this.num = opts.num || 5;
        this.circle = [];
        this.spawn();
    }
    CircleGloup.prototype.spawn = function() {
        for (var i = 0; i < this.num; i++) {
            var star = new Circle({
                radius: this.radius
            });
            this.circle.push(star);
        }
    };
    CircleGloup.prototype.render = function(ctx) {
        var time = Date.now();
        for (var i = 0; i < this.num; i++) {
            this.circle[i].update(i, time);
            this.circle[i].render(ctx);
        }
    };

    var circles = new CircleGloup({
        radius: w/6 >> 0
    });
    var circleParent = new JC.Graphics();
    circleParent.drawCall(function(ctx){
        circles.render(ctx);
    });
    // var line1 = new JC.Graphics();
    // line1.drawCall(function(ctx){
    //     ctx.beginPath();
    //     ctx.fillStyle = "rgba(255,255,255,0.9)";
    //     ctx.moveTo(-60,280);
    //     ctx.lineTo(266,-274);
    //     ctx.lineTo(60,-274);
    //     ctx.lineTo(-266,280);
    //     ctx.fill();
    // });
    // line1.x = 540;
    // line1.y = -1679;
    // line1.to({
    //     to: {x: -296,y: -274},
    //     duration: 400
    // });

    // var line2 = new JC.Graphics();
    // line2.drawCall(function(ctx){
    //     ctx.beginPath();
    //     ctx.fillStyle = "rgba(255,255,255,0.9)";
    //     ctx.moveTo(-60,280);
    //     ctx.lineTo(266,-274);
    //     ctx.lineTo(60,-274);
    //     ctx.lineTo(-266,280);
    //     ctx.fill();
    // });
    // line2.x = -540;
    // line2.y = 1679;
    // line2.to({
    //     to: {x: 296,y: 274},
    //     duration: 400
    // });

    DOC.addChilds(circleParent);//,line1,line2
    stage.addChilds(DOC);

    function render() {
        RAF(render);
        stage.render();
    }
    render();

    function resize() {
        w = window.innerWidth;
        h = window.innerHeight;
        DOC.x = w / 2;
        DOC.y = h / 2;
        stage.resize(w, h);
    }
    </script>
</body>

</html>
